"use strict";var themes=require("../../themes"),tools=require("../../tools"),_=require("lodash"),chalk=require("chalk"),needle=require("needle"),noon=require("noon"),CFILE=process.env.HOME+"/.leximaven.noon";exports.command="example <word>",exports.desc="Wordnik examples",exports.builder={out:{alias:"o",desc:"Write cson, json, noon, plist, yaml, xml","default":"",type:"string"},force:{alias:"f",desc:"Force overwriting outfile","default":!1,type:"boolean"},save:{alias:"s",desc:"Save flags to config file","default":!1,type:"boolean"},limit:{alias:"l",desc:"Limit number of results","default":5,type:"number"},canon:{alias:"c",desc:"Use canonical","default":!1,type:"boolean"},skip:{alias:"k",desc:"Number of results to skip","default":0,type:"number"}},exports.handler=function(e){tools.checkConfig(CFILE);var o=noon.load(CFILE),s={example:{canon:e.c,limit:e.l,skip:e.k}};o.merge&&(o=_.merge({},o,s));var l=themes.loadTheme(o.theme);o.verbose&&themes.labelDown("Wordnik",l,null);var a=e.word,t="examples",r="http://api.wordnik.com:80/v4/word.json/",n=process.env.WORDNIK,i=""+r+a+"/"+t+"?",p=[];p.push("useCanonical="+o.example.canon+"&"),p.push("includeDuplicates=false&"),p.push("limit="+o.example.limit+"&"),o.example.skip?p.push("skip="+o.example.skip+"&"):p.push("skip=0&"),p.push("api_key="+n);var c=p.join(""),m=""+i+c;m=encodeURI(m);var u={type:"example",source:"http://www.wordnik.com"};needle.get(m,function(s,a){if(s||200!==a.statusCode)console.error(chalk.red.bold("HTTP "+a.statusCode+":")+" "+chalk.red(s));else{for(var t=a.body.examples,r=0;r<=t.length-1;r++){var n=t[r];themes.labelRight("Example",l,n.text),u[["example"+r]]=n.text}e.o&&tools.outFile(e.o,e.f,u),e.s&&o.merge&&noon.save(CFILE,o),e.s&&!o.merge&&console.err(chalk.red("Set option merge to true!"))}})};