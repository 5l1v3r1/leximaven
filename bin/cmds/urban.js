"use strict";var themes=require("../themes"),tools=require("../tools"),_=require("lodash"),chalk=require("chalk"),needle=require("needle"),noon=require("noon"),CFILE=process.env.HOME+"/.leximaven.noon";exports.command="urban <query>",exports.desc="Urban Dictionary definitions",exports.builder={out:{alias:"o",desc:"Write cson, json, noon, plist, yaml, xml","default":"",type:"string"},force:{alias:"f",desc:"Force overwriting outfile","default":!1,type:"boolean"},save:{alias:"s",desc:"Save flags to config file","default":!1,type:"boolean"},limit:{alias:"l",desc:"Limit number of results","default":5,type:"number"}},exports.handler=function(e){tools.checkConfig(CFILE);var o=noon.load(CFILE),n={urban:{limit:e.l}};o.prefer&&(o=_.merge({},o,n));var r=themes.loadTheme(o.theme);o.verbose&&themes.labelDown("Urban Dictionary",r,null);var i=e._.slice(1),t="";t=i.length>1?i.join(" "):i[0];var a="http://api.urbandictionary.com/v0/define?term="+t;a=encodeURI(a);var l={type:"urban",source:"http://www.urbandictionary.com"};needle.get(a,function(n,i){if(n||200!==i.statusCode)console.error(chalk.red.bold("HTTP "+i.statusCode+":")+" "+chalk.red(n));else{for(var t=o.urban.limit,a=i.body.list.slice(0,t),s=0;s<=a.length-1;s++){var d=a[s];themes.labelDown("Definition",r,d.definition),l[["definition"+s]]=d.definition}e.o&&tools.outFile(e.o,e.f,l),e.s&&o.prefer&&noon.save(CFILE,o)}})};