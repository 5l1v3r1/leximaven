"use strict";var themes=require("../../themes"),tools=require("../../tools"),_=require("lodash"),chalk=require("chalk"),needle=require("needle"),noon=require("noon"),CFILE=process.env.HOME+"/.leximaven.noon";exports.command="info <word>",exports.desc="Rhymebrain word info",exports.builder={out:{alias:"o",desc:"Write cson, json, noon, plist, yaml, xml","default":"",type:"string"},force:{alias:"f",desc:"Force overwriting outfile","default":!1,type:"boolean"},save:{alias:"s",desc:"Save flags to config file","default":!1,type:"boolean"},lang:{alias:"l",desc:"ISO 639-1 language code","default":"en",type:"string"}},exports.handler=function(e){tools.checkConfig(CFILE);var o=noon.load(CFILE),l={info:{lang:e.l,max:e.m}};o.merge&&(o=_.merge({},o,l));var a=themes.loadTheme(o.theme);o.verbose&&themes.labelDown("Rhymebrain",a,null);var t=e.word,n="WordInfo",r="http://rhymebrain.com/talk?function=get",s=""+r+n+"&word="+t+"&",i=[];i.push("lang="+o.info.lang+"&"),i.push("maxResults="+o.info.max+"&");var d=i.join(""),c=""+s+d;c=encodeURI(c),themes.labelDown("Word Info",a,null);var h={type:"word info",source:"http://rhymebrain.com"},u=_.get(chalk,a.content.style);needle.get(c,function(l,t){if(l||200!==t.statusCode)console.error(chalk.red.bold("HTTP "+t.statusCode+":")+" "+chalk.red(l));else{var n=t.body;themes.labelRight("Arpabet",a,n.pron),themes.labelRight("IPA",a,n.ipa),themes.labelRight("Syllables",a,n.syllables),h.arpabet=n.pron,h.ipa=n.ipa,h.syllables=n.syllables;var r=[];n.flags.match(/a/)&&(r.push(u("["+chalk.red.bold("Offensive")+"]")),h.offensive=!0),n.flags.match(/b/)&&(r.push(u("[Found in dictionary]")),h.dict=!0),n.flags.match(/c/)&&(r.push(u("[Trusted pronunciation, not generated]")),h.trusted=!0),themes.labelRight("Word Flags",a,r.join("")),e.o&&tools.outFile(e.o,e.f,h),e.s&&o.merge&&noon.save(CFILE,o),e.s&&!o.merge&&console.err(chalk.red("Set option merge to true!"))}})};