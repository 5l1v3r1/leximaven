"use strict";var themes=require("../../themes"),tools=require("../../tools"),_=require("lodash"),chalk=require("chalk"),needle=require("needle"),noon=require("noon"),CFILE=process.env.HOME+"/.leximaven.noon";exports.command="info <word>",exports.desc="Rhymebrain word info",exports.builder={out:{alias:"o",desc:"Write cson, json, noon, plist, yaml, xml","default":"",type:"string"},force:{alias:"f",desc:"Force overwriting outfile","default":!1,type:"boolean"},save:{alias:"s",desc:"Save flags to config file","default":!1,type:"boolean"},lang:{alias:"l",desc:"ISO 639-1 language code","default":"en",type:"string"}},exports.handler=function(e){tools.checkConfig(CFILE);var o=noon.load(CFILE),a={info:{lang:e.l,max:e.m}};o.prefer&&(o=_.merge({},o,a));var l=themes.loadTheme(o.theme);o.verbose&&themes.labelDown("Rhymebrain",l,null);var n=e.word,t="WordInfo",s="http://rhymebrain.com/talk?function=get",r=""+s+t+"&word="+n+"&",i=[];i.push("lang="+o.info.lang+"&"),i.push("maxResults="+o.info.max+"&");var d=i.join(""),h=""+r+d;h=encodeURI(h),themes.labelDown("Word Info",l,null);var c={type:"word info",source:"http://rhymebrain.com"},u=_.get(chalk,l.content.style);needle.get(h,function(a,n){if(a||200!==n.statusCode)console.error(chalk.red.bold("HTTP "+n.statusCode+":")+" "+chalk.red(a));else{var t=n.body;themes.labelRight("Arpabet",l,t.pron),themes.labelRight("IPA",l,t.ipa),themes.labelRight("Syllables",l,t.syllables),c.arpabet=t.pron,c.ipa=t.ipa,c.syllables=t.syllables;var s=[];t.flags.match(/a/)&&(s.push(u("["+chalk.red.bold("Offensive")+"]")),c.offensive=!0),t.flags.match(/b/)&&(s.push(u("[Found in dictionary]")),c.dict=!0),t.flags.match(/c/)&&(s.push(u("[Trusted pronunciation, not generated]")),c.trusted=!0),themes.labelRight("Word Flags",l,s.join("")),e.o&&tools.outFile(e.o,e.f,c),e.s&&o.prefer&&noon.save(CFILE,o)}})};